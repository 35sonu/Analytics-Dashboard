// This is your Prisma schema file

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Vendor {
  id        String    @id @default(cuid())
  name      String
  email     String?
  phone     String?
  address   String?
  createdAt DateTime  @default(now())
  updatedAt DateTime  @updatedAt
  invoices  Invoice[]
}

model Customer {
  id        String    @id @default(cuid())
  name      String
  email     String?
  phone     String?
  address   String?
  createdAt DateTime  @default(now())
  updatedAt DateTime  @updatedAt
  invoices  Invoice[]
}

model Invoice {
  id             String        @id @default(cuid())
  invoiceNumber  String        @unique
  vendorId       String
  customerId     String?
  invoiceDate    DateTime
  dueDate        DateTime?
  totalAmount    Float
  status         String        @default("pending")
  category       String?
  description    String?
  documentUrl    String?
  createdAt      DateTime      @default(now())
  updatedAt      DateTime      @updatedAt
  vendor         Vendor        @relation(fields: [vendorId], references: [id])
  customer       Customer?     @relation(fields: [customerId], references: [id])
  lineItems      LineItem[]
  payments       Payment[]

  @@index([invoiceDate])
  @@index([vendorId])
  @@index([status])
}

model LineItem {
  id          String   @id @default(cuid())
  invoiceId   String
  description String
  quantity    Float
  unitPrice   Float
  amount      Float
  category    String?
  createdAt   DateTime @default(now())
  invoice     Invoice  @relation(fields: [invoiceId], references: [id], onDelete: Cascade)

  @@index([invoiceId])
}

model Payment {
  id            String   @id @default(cuid())
  invoiceId     String
  paymentDate   DateTime
  amount        Float
  paymentMethod String?
  reference     String?
  createdAt     DateTime @default(now())
  invoice       Invoice  @relation(fields: [invoiceId], references: [id], onDelete: Cascade)

  @@index([invoiceId])
  @@index([paymentDate])
}
